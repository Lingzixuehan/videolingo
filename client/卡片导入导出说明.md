# 学习卡片转换与 JSON 导出功能说明

## 功能概述

本功能实现了将词汇 JSON 数据转换为学习卡片，并支持卡片的导入导出操作。

## 文件格式

### 1. 词汇 JSON 格式（用于导入）

示例文件：`input-labels.json`

```json
{
  "source": "input.srt",
  "path": "D:\\videolingo\\input.srt",
  "blocks": [
    {
      "index": 1,
      "start": "00:00:00,000",
      "end": "00:00:08,000",
      "text": "Yes, I came here...",
      "words": [
        {
          "original": "Yes",
          "entry": {
            "word": "yes",
            "phonetic": "jes",
            "definition": "n. an affirmative",
            "translation": "adv. 是\nn. 是, 同意",
            "collins": 5,
            "oxford": 1,
            "tag": "zk gk"
          }
        }
      ]
    }
  ],
  "word_map": {
    "yes": {
      "word": "yes",
      "phonetic": "jes",
      "definition": "n. an affirmative",
      "translation": "adv. 是\nn. 是, 同意",
      "collins": 5,
      "oxford": 1,
      "tag": "zk gk"
    }
  }
}
```

### 2. 导出的卡片 JSON 格式

导出文件名格式：`videolingo-cards-YYYY-MM-DD.json`

```json
{
  "exportedAt": "2025-01-01T12:00:00.000Z",
  "version": "1.0",
  "totalCards": 10,
  "cards": [
    {
      "id": "abc123",
      "type": "word",
      "front": "example",
      "back": "示例；例子",
      "videoTitle": "input.srt",
      "ease": "normal",
      "lastReviewedAt": "2025-01-01T12:00:00.000Z",
      "nextReviewAt": "2025-01-02T12:00:00.000Z",
      "phonetic": "ɪɡˈzɑːmpl",
      "definition": "n. a thing characteristic of its kind",
      "translation": "n. 例子，范例",
      "tag": "cet4 cet6"
    }
  ]
}
```

## 使用方法

### 导入词汇

1. 打开客户端，进入「学习卡片管理」页面
2. 点击右上角的「导入词汇」按钮
3. 选择 JSON 文件（支持词汇 JSON 或导出的卡片 JSON）
4. 系统会自动识别格式并导入
5. 导入完成后显示统计信息：
   - 总词汇/卡片数
   - 新增数量
   - 跳过数量（已存在的不会重复导入）

### 导出卡片

1. 在「学习卡片管理」页面
2. 点击「导出卡片」按钮
3. 浏览器会自动下载 JSON 文件
4. 文件可用于备份或在其他设备导入

## 修改的文件

### 1. `videolingo/front/src/renderer/store/cards.ts`

**新增接口定义：**
- `VocabEntry` - 词汇条目接口
- `VocabWord` - 词汇 JSON 中的单词项
- `VocabBlock` - 词汇 JSON 中的字幕块
- `VocabJSON` - 词汇 JSON 文件格式

**扩展 CardItem 接口，增加字段：**
- `phonetic` - 音标
- `definition` - 英文释义
- `translation` - 中文翻译
- `pos` - 词性
- `tag` - 词汇等级标签（如 CET4、CET6、TOEFL）
- `collins` - 柯林斯词频
- `oxford` - 牛津核心词

**新增 actions：**
- `importFromVocabJSON(vocabData)` - 从词汇 JSON 导入学习卡片
- `exportToJSON()` - 导出所有卡片为 JSON 字符串
- `importFromExportedJSON(jsonStr)` - 从导出的 JSON 重新导入
- `clearAll()` - 清空所有卡片

### 2. `videolingo/front/src/renderer/pages/Cards.vue`

**模板修改：**
- 添加「导入词汇」按钮
- 添加「导出卡片」按钮
- 添加隐藏的文件选择 input

**脚本新增：**
- `triggerImport()` - 触发文件选择对话框
- `handleFileImport()` - 处理文件导入逻辑
- `exportCards()` - 处理卡片导出逻辑

**样式新增：**
- `.btn` - 按钮基础样式
- `.btn-primary` - 主要按钮样式（蓝色）
- `.btn-secondary` - 次要按钮样式（灰色）

## 技术特性

- **自动去重**：导入时按单词（front 字段）去重，已存在的卡片不会重复添加
- **格式自动识别**：系统会自动判断是词汇 JSON 还是导出的卡片 JSON
- **保留完整信息**：导入时保留音标、释义、词汇等级等详细信息
- **跳过空词条**：没有翻译和释义的常见词（如 the, a, is）会被自动跳过

## 验收标准

✅ 生成的 JSON 文件能被客户端加载并展示
✅ 支持从词汇 JSON 导入学习卡片
✅ 支持导出学习卡片为 JSON
✅ 支持从导出的 JSON 重新导入
✅ UI 提供导入/导出操作按钮
